# キーボードでマウスを操作するプログラム

プログラム起動中にキーボードショートカットでマウス操作をエミュレートします。
json プロファイルで操作内容を定義します。これは `mise run emulate` で実行する際にプロファイルを引数として渡すことで任意のプロファイルを使用できます。
mise と uv の仕様は `docs/mise` と `docs/uv` を参照してください。

## サービス構成

- タスク管理 mise
- python パッケージ管理 uv

## ディレクトリ構成

```plain
src/
mise.toml
pyproject.toml
profiles/****.json
```

## json プロファイル例

```json
[
    {
        "description": "決定ボタンをクリック",
        "click_position": {"x": 0.9, "y": 0.1},
        "key": ["shift", "enter"],
    }
]
```

## メインの　mise コマンド

```bash
mise run emulate <profiles/example.json> # プロファイルを指定して実行
mise run register <profile-name> # プロファイルを登録する
```

## 登録プログラムの仕様

PC の画面サイズが変動しても対応できるように、座標は相対的な位置で指定します。

1. まず、画面にカーソルを合わせて `shift + enter` を押すことで、対応する領域のキャリブレーションを行います。移行のクリック位置はこのキャリブレーションに基づいて計算されます。
2. そのあとはプロファイルの登録モードに移ります。登録モードでは、キーを押下したあと、クリックをすることでその位置を登録できます。キーの変更したい場合はクリックする前に別のキーを押下してください。
3. 登録が完了したら、`esc` キーを押すことで登録モードを終了します。
4. 登録されたプロファイルは `profiles/` ディレクトリに json ファイルとして保存されます。

## 実行プログラムの仕様

1. 登録プログラムと同様に、まずキャリブレーションを行います。キャリブレーションが完了したら、登録されたプロファイルに基づいてマウス操作をエミュレートします。
2. `esc` または `ctrl + c` でプログラムを終了します。

## 注意点

apple silicon の macOS を対象とします。
キーについては `fn`, `shift`, `ctrl`, `alt`, `cmd` などの修飾キーと通常キーの組み合わせによるクリックもサポートします。ただし、`esc` と `ctrl + c` は終了コマンドとして予約されているため、これらのキーをクリック操作に割り当てることはできません。
以前プロトタイプを作った際に以下の問題があったので、それが起こらないようにしてください。

- マウスが移動してクリックするシステムの場合、移動前の座標でクリックしてしまう問題
- キー入力がうまく認識されない問題
- マウス移動と関係なく指定した座標をクリックするシステムの場合、修飾キーの組み合わせがうまく動作しない問題、またはプログラムが途中でクラッシュする

マウス移動方式と、しない方式についてはどっちがいいかをよく検討してください。
