# What is Docker?

<!-- markdownlint-disable MD033 -->

Docker とは **アプリケーションとその実行に必要な環境をまとめて「コンテナ」と呼ばれる独立したパッケージにする技術** のこと。

下記の表を見れば一目瞭然だが、アプリケーションを実行するための全ての要素を独立したパッケージにすることで、どんな環境（誰の PC でも、どんな OS でも）でも Docker 上で同じように動作させられる。

つまり、人・PC によって「なぜか動かない」「環境構築でつまる」などの問題を解決できる。

| 管理・統一できるもの                                                     | 従来の環境                   | Docker                                                                   |
| :----------------------------------------------------------------------- | :--------------------------- | :----------------------------------------------------------------------- |
| アプリケーション                                                         | 〇                           | 〇                                                                       |
| アプリケーションの依存関係・ライブラリ                                   | △（poetry などで管理できる） | 〇（内部的に言語ごとに適したパッケージマネージャーを利用するとなお良い） |
| アプリケーションの実行環境（例：Python、Ruby、Node.js やそのバージョン） | ×                            | 〇                                                                       |
| ミドルウェア（例：データベース、Web サーバーなど）                       | ×                            | 〇                                                                       |
| OS                                                                       | ×                            | 〇                                                                       |

## Docker が動作する仕組み

※ [Docker 概要 | Docker ドキュメント](https://matsuand.github.io/docs.docker.jp.onthefly/get-started/overview/)

### Docker Daemon (dockerd)

Docker の中核となる構成要素（Docker Engine）で、Docker API のリクエストを受け付けて、イメージ、コンテナー、ネットワーク、ボリュームといった Docker オブジェクトを管理する。

### Docker Client (docker)

ユーザーが Docker Engine とやり取りするためのインターフェイス（CLI や GUI）で、Docker Engine に対してコマンドを送信する役割を果たす。

### Docker Desktop

Windows や macOS 上で Docker を簡単に使用できるようにするための GUI ツールで、Docker daemon、Docker CLI、Docker Compose などを統合して提供する。

### Docker Registry

Docker イメージを保存するための場所。なかでも Docker Hub や Docker Cloud はだれでも利用可能な公開レジストリであり、docker はデフォルトで Docker Hub を参照するように設定されている。
プライベートなレジストリを構築することも可能で、社内の開発チームやプロジェクト専用のイメージを管理するために使用されることがある。

<img src="https://matsuand.github.io/docs.docker.jp.onthefly/engine/images/architecture.svg" alt="Docker Architecture" width="100%" height="360px">

### Docker Objects

Docker では、イメージ、コンテナ、ボリューム、ネットワークなどのオブジェクトを管理する。
ここではイメージとコンテナの概要のみを説明する。
ざっくり言えば、Dockerfile がイメージの「設計図」で、イメージが「設計図をもとに作られたテンプレート」、コンテナが「設計図をもとに作られた実行可能なインスタンス」になる。

### イメージ

イメージは Docker コンテナを作成する命令群をパッケージングした読み取り専用のテンプレートで、アプリケーションを実行するための全ての要素（コード、ライブラリ、環境変数、設定ファイルなど）を含む。
イメージは `Dockerfile` という定義ファイルからビルドされ、Docker Hub やプライベートなレジストリに保存される。
イメージはレイヤー構造を持ち、各レイヤーは前のレイヤーに基づいて変更を加えたものとなっている。

### コンテナ

コンテナはイメージを基に生成される実行可能なインスタンスで、アプリケーションが実際に動作する環境を指す。
イメージのレイヤー上に書き込み可能なレイヤーを追加して、アプリケーションを実行する。
コンテナは同じイメージから複数生成でき、互いに隔離されている。そのためコンテナが他の環境やホスト OS に影響を与えることはない。
