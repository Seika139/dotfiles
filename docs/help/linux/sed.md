# sed コマンド

```bash
sed オプション スクリプトコマンド 入力ファイル
```

## オプション

`-i` : ファイルを上書きする
`-i [バックアップ拡張子]` : BSD版(mac) ではバックアップ拡張子の指定が必須。バックアップ不要なら `''` を指定
`-r`, `-E` : 拡張正規表現を使用する
`-e` : 複数のスクリプトコマンドを一度に実行する → `sed -e 's/A/B/' -e 's/C/B/'`

## スクリプトコマンド

`s/X/Y/` : 入力ファイルのうち X と合致した最初の部分を Y に置換する
`s/X/Y/g` : 入力ファイルのうち X と合致したすべての箇所を Y に置換する

## その他のユースケース

```bash
sed '5s/foo/bar/' file         # 5行目の foo を bar に置き換える
sed '7c\ text' file            # 7行目を text に置き換える
sed '7a\ text' file            # 7行目の後ろに text と書かれた行を追加する
sed '7i\ text' file            # 7行目の前に text と書かれた行を追加する
sed '3,6d' file                # 3 ~ 6行目を削除する
sed '/pattern/s/foo/bar/' file # pattern に該当する行の foo を bar に置き換える
```

## 注意点

- c,a,i は続くバックスラッシュ `\` がなくても動くが先頭に空白文字を入れるときに必要になる。
- BSD版(mac) では `\` の後ろで改行をするか、`$''` と囲んで改行コードを加える必要がある。
  BSD版のコマンドよりもGNU版の方がLinux標準と同じ動作を期待できるので、BSD版が面倒ならGNU版のコマンドをインストールする

  ```bash
  # BSD版(mac)
  sed -i '17i\ some text' file
  # GNU版(win)
  sed -i '' $'17i\\\n some text\n' file (バックスラッシュは3つ。末尾にも改行コードを入れる)
  ```
